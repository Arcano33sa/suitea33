<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Suite A33 · Arcano 33</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#111111" />
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png" />
  <link rel="apple-touch-icon" href="icon-192.png" />
  <style>
    * { box-sizing: border-box; font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #3b1a2a 0, #050506 55%, #000 100%);
      color: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .app-shell {
      width: 100%;
      max-width: 960px;
      padding: 1.5rem 1.25rem 2.5rem;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .logo-wrap {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .logo-wrap img {
      width: 52px;
      height: 52px;
      border-radius: 999px;
      box-shadow: 0 0 18px rgba(221,191,100,0.55);
    }
    .brand-text {
      display: flex;
      flex-direction: column;
    }
    .brand-text span:nth-child(1) {
      font-size: 0.78rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: #c0a96b;
    }
    .brand-text span:nth-child(2) {
      font-size: 1.1rem;
      font-weight: 600;
    }
    .brand-text span:nth-child(3) {
      font-size: 0.8rem;
      color: #aaa;
    }
    .badge {
      border-radius: 999px;
      padding: 0.25rem 0.75rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      border: 1px solid rgba(221,191,100,0.55);
      color: #ddbf64;
    }
    main {
      margin-top: 0.75rem;
    }
    .cards-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
    }
    .card {
      position: relative;
      padding: 1rem;
      border-radius: 12px;
      background: linear-gradient(145deg, rgba(15,15,20,0.96), rgba(45,20,35,0.98));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow:
        0 18px 40px rgba(0,0,0,0.8),
        0 0 0 1px rgba(255,255,255,0.02);
      cursor: pointer;
      transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
    }
    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(circle at top, rgba(221,191,100,0.22), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
      pointer-events: none;
    }
    .card:hover {
      transform: translateY(-3px);
      border-color: rgba(221,191,100,0.4);
      box-shadow:
        0 24px 50px rgba(0,0,0,0.9),
        0 0 0 1px rgba(221,191,100,0.4);
    }
    .card:hover::before { opacity: 1; }
    .card h3 {
      margin: 0 0 0.35rem;
      font-size: 1rem;
    }
    .card p {
      margin: 0;
      font-size: 0.82rem;
      color: #c9c9c9;
    }
    .card span.tag {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: #b98fef;
      margin-bottom: 0.4rem;
    }
    .card span.tag i {
      width: 8px; height: 8px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #ffd27f, #d79a2b);
      box-shadow: 0 0 12px rgba(255, 210, 127, 0.9);
    }
    .subtitle {
      font-size: 0.78rem;
      color: #b7b7b7;
      margin-bottom: 0.75rem;
    }
    footer {
      margin-top: 1.25rem;
      font-size: 0.72rem;
      color: #808080;
      display: flex;
      justify-content: space-between;
      gap: 0.75rem;
      flex-wrap: wrap;
    }
    footer span strong { color: #ddbf64; }

    .pin-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #1e1017 0, #000 58%, #000 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .pin-card {
      width: 100%;
      max-width: 360px;
      background: rgba(10,10,14,0.96);
      border-radius: 16px;
      padding: 1.4rem 1.3rem 1.6rem;
      border: 1px solid rgba(221,191,100,0.55);
      box-shadow: 0 26px 60px rgba(0,0,0,0.9);
    }
    .pin-card h2 {
      margin: 0 0 0.25rem;
      font-size: 1.05rem;
    }
    .pin-card p {
      margin: 0;
      font-size: 0.78rem;
      color: #c3c3c3;
    }
    .pin-input-wrap {
      margin-top: 0.9rem;
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }
    .pin-input-wrap input {
      flex: 1;
      padding: 0.45rem 0.6rem;
      border-radius: 999px;
      border: 1px solid #444;
      background: #050509;
      color: #f5f5f5;
      font-size: 0.9rem;
      text-align: center;
      letter-spacing: 0.3em;
    }
    .pin-input-wrap button {
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #ddbf64, #f4e3a0);
      color: #14120b;
      font-weight: 600;
      font-size: 0.85rem;
      cursor: pointer;
    }
    .pin-error {
      margin-top: 0.5rem;
      font-size: 0.75rem;
      color: #ff8b8b;
      min-height: 1em;
    }
    .pin-hint {
      margin-top: 0.45rem;
      font-size: 0.72rem;
      color: #9b9b9b;
    }

    @media (max-width: 640px) {
      .app-shell { padding: 1.25rem 1rem 2rem; }
      header { flex-direction: column; align-items: flex-start; }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="logo-wrap">
        <img src="icon-192.png" alt="Arcano 33" />
        <div class="brand-text">
          <span>Suite A33</span>
          <span>Arcano 33 · Backstage</span>
          <span>Control de producción, lotes y ventas</span>
        </div>
      </div>
      <span class="badge">Acceso privado</span>
    </header>
    <p class="subtitle">
      El laboratorio interno de Arcano 33: aquí viven tus recetas, cálculos de producción, control de lotes y punto de venta.
    </p>
    <main>
      <div class="cards-grid">
        <div class="card" data-target="calculadora_a33/">
          <span class="tag"><i></i>Producción</span>
          <h3>Calculadora de Producción</h3>
          <p>Define recetas y calcula materia prima para tus lotes.</p>
        </div>
        <div class="card" data-target="lotes/">
          <span class="tag"><i></i>Lotes</span>
          <h3>Control de Lotes</h3>
          <p>Registra volúmenes, fechas de caducidad y notas de cada lote de Sangría Artesanal Premium.</p>
        </div>
        <div class="card" data-target="pos/">
          <span class="tag"><i></i>Ventas</span>
          <h3>A33 POS Offline</h3>
          <p>Registra ventas por evento y controla inventario por presentación.</p>
        </div>
      </div>
    </main>
    <footer>
      <span>Arcano 33 · <strong>Sangría Artesanal Premium</strong></span>
      <span>Suite A33 v5 · Uso interno</span>
    </footer>
  </div>

  <div id="pinOverlay" class="pin-overlay">
    <div class="pin-card">
      <h2 id="pinTitle">Configurar PIN de acceso</h2>
      <p id="pinMessage">Crea tu PIN de 6 dígitos para proteger la Suite A33.</p>
      <div class="pin-input-wrap">
        <input id="pinInput" type="password" inputmode="numeric" maxlength="6" autocomplete="off" />
        <button id="pinBtn">Guardar PIN</button>
      </div>
      <div id="pinError" class="pin-error"></div>
      <div class="pin-hint" id="pinHint">La primera vez defines el PIN. Guárdalo en un lugar seguro.</div>
    </div>
  </div>

  <script>
    const SUITE_PIN_KEY = 'suite_a33_pin_v1';
    const SUITE_SESSION_OK = 'suite_a33_session_ok_v1';

    function hasStoredPin(){
      try {
        const v = localStorage.getItem(SUITE_PIN_KEY);
        return !!(v && v.length === 6);
      } catch(e){
        return false;
      }
    }
    function getStoredPin(){
      try {
        const v = localStorage.getItem(SUITE_PIN_KEY);
        return (v && v.length === 6) ? v : null;
      } catch(e){
        return null;
      }
    }
    function isSessionOpen(){
      try {
        return sessionStorage.getItem(SUITE_SESSION_OK) === '1';
      } catch(e) { return false; }
    }
    function openSession(){
      try { sessionStorage.setItem(SUITE_SESSION_OK, '1'); } catch(e){}
    }
    function hidePinOverlay(){
      const ov = document.getElementById('pinOverlay');
      if (ov) ov.style.display = 'none';
    }
    function showPinOverlay(){
      const ov = document.getElementById('pinOverlay');
      if (ov) ov.style.display = 'flex';
    }
    function updatePinUI(){
      const hasPin = hasStoredPin();
      const title = document.getElementById('pinTitle');
      const msg = document.getElementById('pinMessage');
      const hint = document.getElementById('pinHint');
      const btn = document.getElementById('pinBtn');
      if (!title || !msg || !hint || !btn) return;
      if (hasPin){
        title.textContent = 'Suite A33 protegida';
        msg.textContent = 'Ingresa el PIN interno para acceder al laboratorio de Arcano 33.';
        hint.textContent = 'PIN de 6 dígitos definido por El Alquimista.';
        btn.textContent = 'Entrar';
      } else {
        title.textContent = 'Configurar PIN de acceso';
        msg.textContent = 'Crea tu PIN de 6 dígitos para proteger la Suite A33.';
        hint.textContent = 'La primera vez defines el PIN. Guárdalo en un lugar seguro.';
        btn.textContent = 'Guardar PIN';
      }
    }
    function checkStartup(){
      if (isSessionOpen()){
        hidePinOverlay();
      } else {
        showPinOverlay();
      }
      updatePinUI();
    }
    function handlePinSubmit(){
      const input = document.getElementById('pinInput');
      const err = document.getElementById('pinError');
      const value = (input.value || '').trim();
      if (value.length !== 6 || !/^[0-9]+$/.test(value)){
        err.textContent = 'El PIN debe tener exactamente 6 dígitos numéricos.';
        return;
      }
      if (!hasStoredPin()){
        try {
          localStorage.setItem(SUITE_PIN_KEY, value);
        } catch(e) {}
        err.textContent = '';
        openSession();
        hidePinOverlay();
        return;
      }
      const realPin = getStoredPin();
      if (!realPin || value !== realPin){
        err.textContent = 'PIN incorrecto. Intenta de nuevo.';
        return;
      }
      err.textContent = '';
      openSession();
      hidePinOverlay();
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      checkStartup();
      const input = document.getElementById('pinInput');
      const btn = document.getElementById('pinBtn');
      btn.addEventListener('click', handlePinSubmit);
      input.addEventListener('keyup', (ev)=>{
        if (ev.key === 'Enter') handlePinSubmit();
      });

      document.querySelectorAll('.card').forEach(card=>{
        card.addEventListener('click', ()=>{
          if (!isSessionOpen()){
            showPinOverlay();
            updatePinUI();
            return;
          }
          const target = card.getAttribute('data-target');
          if (target) window.location.href = target;
        });
      });
    });
  </script>
</body>
</html>
